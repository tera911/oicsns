<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css" rel="stylesheet">
        <meta name="viewport" content="width=device-width">
        <style>
            button{
                margin:5px;
            }
            .status{
                width:100%;
                height:200px;
                overflow:scroll;
                overflow-x: hidden;
            }
        </style>
        <script type="text/javascript">
            
        var ws = new WebSocket('ws://127.0.0.1:8080/ws');
        ws.onopen = function(){
           // ws.send("ping");
        };
        ws.onerror = function(error){
            console.log('WebSocket Error ' + error);
        };
       ws.onmessage = function(e){
           console.log('Server: '+e.data);
           var data = JSON.parse(e.data);
           for(var i in data){
           var value = data[i];
               $('.status').append("<p>"+i + ":" + value +"</p>");
           }
           $('.status').append("<hr>");
       };
       
       function serializeFormToObj(form){
           var param = {};
           $(form.serializeArray()).each(function(i,v){param[v.name] = v.value});
           return param;
       }
        //onload    
        $(function(){
                $('button[name="login"]').click(function(){
                    obj = serializeFormToObj($('#Login'));
                    obj.method = "login";
                    ws.send(JSON.stringify(obj));
                });
            $('button[name="allchat"]').click(function(){
                    obj = serializeFormToObj($('#chat input[name="text"]'));
                    obj.method = "allchat";
                    obj.key = "oniipon";
                    ws.send(JSON.stringify(obj));
                });
                
                $('button[name="cmd"]').click(function(){
                   obj = {};
                   obj.cmd = $('#chat input[name="text"]').val();
                   obj.method = "cmd";
                   obj.key = "oniipon";
                   ws.send(JSON.stringify(obj));
               });
            });
        </script>
    </head>
    <body>
        <div class="wrap container row">
            <div class="col-md-8 col-md-offset-2">
                <h1 class="text-center">Test page for OICSNS</h1>
                <div class="row">
                    <div class="col-md-12">
                        <p>status</p>
                        <p class="status"></p>
                        <form class="form-group" id="Login">
                            <label>name</label><input type="text" name="userid">
                            <label>pw</label><input type="text" name="password">
                        </form>
                        <form class="form-group" id="chat">
                            <label>chat</label><input type="text" name="text">
                            <label>chatlog</label><textarea name="chatlog"></textarea>
                        </form>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="actionButton">
                            <button name="login" class="btn btn-primary">Login</button>
                            <button name="" class="btn btn-primary">Logout</button>
                            
                            <button name="getlog" class="btn btn-primary">chatlog取得//廃止</button>
                            <button name="allchat" class="btn btn-primary">全体チャット</button>
                            <button name="" class="btn btn-primary">プロフィール取得</button>
                            <button name="" class="btn btn-primary">プロフィール設定</button>
                            <button name="cmd" class="btn btn-primary">command</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
